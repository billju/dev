<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <header>
        <video></video>
        <h1>烏日文心北屯線</h1>
        <countdown>距離通車 ...天</countdown>
    </header>
    <section>
        <h1>一瞥</h1>
        <p>東起自臺中市北屯區松竹路二號橋附近，以高架型式沿松竹路西行跨越臺鐵再左轉至北屯路，沿北屯路至文心路四段路口前右轉文心路，經文心南路由中山醫學大學後方轉到建國路，並跨越環中路高架橋及穿越中彰快速道路後，沿鐵路北側跨越筏子溪進入高鐵臺中站區。</p>
        <p>全長約16.71公里，共設置18座高架車站，全線規劃有6站 7處捷運車站共構的土地開發場站，並於105年開工。其中G4松竹站、G13大慶站及G17臺中高鐵站為與臺鐵、高鐵的轉乘車站。</p>
        <h1>系統型式</h1>
        <p></p>
        <h1>工程進度</h1>
        <h2>路線土建標案</h2>
        <h2>共構出入口標案</h2>
        <h1>展望</h1>
        <p>全線高架車站土木建築已完成橋墩、橋梁、軌道、車站結構等工程，正持續進行車站水電環控及室內裝修工程，目前CJ910區段標已於108年2月18日完成竣工，其餘各標皆同步推動中，市府和臺北市政府捷運工程局嚴謹並持續進行各土地開發共構場站出入口建築基地結構體施工、捷運車站站體裝修收尾、車站與出入口水電環控施工以及地面景觀復舊施工。機電部分，18列電聯車已於106年底運抵北屯機廠，並上主線測試，刻正進行機電子系統測試；另土地開發招商作業持續進行</p>
        <p>捷運綠線已於107年正式啟動試運轉，臺中捷運採無人自動駕駛，採用世界最先進的機電系統-通訊式列車控制技術(CBTC)，讓電聯車行進時，藉由無線通訊方式依預定班表行進及停靠，將電聯車控制於移動式閉塞區間，維持安全的行車間距，自動等級為世界最高等級的GOA-4，安全等級亦是最高級的SIL4。未來捷運綠線通車後，民眾從G0 北屯總站至G17臺中高鐵站搭乘時間為38分鐘，臺中將正式邁入捷運時代。</p>
    </section>
    <footer>
        <h3>聯絡方式</h3>
    </footer>
   
    <nav>車站</nav>
    <nav>新聞與工程現況</nav>
    <nav>大事紀</nav>
    <div data-0="transform:translateY(100px)" data-123="transform:translateY(500px)">bang</div>
    <div class="num">1</div>
</body>
<style>
    *{
        font-family: monospace;
        text-align: right;
    }
</style>
<script>
    function skr(node=document.body){
        let datas = Object.entries(node.dataset)
        let rect = node.getBoundingClientRect()
        let keyPoints = []
        for(let data of datas){
            let [key,value] = data
            let y = undefined
            if(key=='center')
                y = Math.round((rect.bottom-rect.top)/2)
            if(key=='top'||key=='bottom')
                y = rect[key]
            let numeric = key.match(/^(\d+)$/)
            if(numeric)
                y = parseInt(numeric[1])
            if(y!=undefined)
                keyPoints.push({y, cssText:node.dataset[key]})
        }
        if(datas.length){
            keyPoints.sort((a,b)=>a.y-b.y)
            function getMatchArray(string,regexp){
                return Array.from(string.matchAll(regexp),x=>x[0])
            }
            function handleScroll(){
                let cssText = keyPoints[keyPoints.length-1].cssText
                for(let i=1;i<keyPoints.length;i++){
                    if(keyPoints[i].y>window.scrollY){
                        let prev = keyPoints[i-1]
                        let next = keyPoints[i]
                        let ratio = (window.scrollY-prev.y)/(next.y-prev.y)
                        cssText = cssText.replace(/\d+/g, '{}')
                        let prevs = getMatchArray(prev.cssText, /(\d+)/g)
                        let nexts = getMatchArray(next.cssText, /(\d+)/g)
                        prevs.map((a,i)=>{
                            a = parseInt(a)
                            let b = parseInt(nexts[i])
                            let value = Math.round( a*(1-ratio)+b*ratio )
                            cssText = cssText.replace('{}',value)
                        })
                        break
                    }
                }
                node.style.cssText = cssText
            }
            window.addEventListener('scroll',handleScroll)
            handleScroll()
        }
        for(let child of node.children){
            skr(child)   
        }
    }
    skr()
    var pe = [], prevDiff = 0
    window.onpointerdown = e=>{
        pe.push(e)
        if(pe.length==2){
            let dx = pe[0].clientX-pe[1].clientX
            let dy = pe[0].clientY-pe[1].clientY
            prevDiff = Math.sqrt(dx*dx+dy*dy)
        }
    }
    window.onpointermove = e=>{
        if(pe.length==2){
            let dx = pe[0].clientX-pe[1].clientX
            let dy = pe[0].clientY-pe[1].clientY
            let diff = Math.sqrt(dx*dx+dy*dy)
            console.log(diff/prevDiff)
        }
    }
    const handlePointerup = e=>{
        pe = []
    }
    window.onpointerup = handlePointerup
    window.onpointercancel = handlePointerup
    window.onpointerout = handlePointerup
    window.onpointerleave = handlePointerup
</script>
</html>