<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Chart</title>
</head>
<body>
    <main id="main">
        <div id="tree-chart" style="position:relative"></div>
        <div id="super-long"></div>
    </main>
</body>
<style>
#super-long{
    width: 100vw;
    height: 3000px;
    background: linear-gradient(0deg,#000 0%,#fff 100%);
}
</style>
<script>
let data = Array.from(Array(10),x=>Math.random()*200).sort((a,b)=>b-a)
let rect = {x:0,y:0,w:200,h:100,v:data.reduce((acc,cur)=>acc+cur,0)}
let rects = []
for(let i=0;i<data.length;i++){
    if(i%2==0){
        let w = rect.w*data[i]/rect.v
        rects.push({
            x:rect.x,
            y:rect.y,
            w:w,
            h:rect.h,
            v:data[i]
        })
        rect.x+=w
        rect.w-=w
    }else{
        let h = rect.h*data[i]/rect.v
        rects.push({
            x:rect.x,
            y:rect.y,
            w:rect.w,
            h:h,
            v:data[i]
        })
        rect.y+=h
        rect.h-=h
    }
    rect.v-=data[i]
}
let treeChart = document.getElementById('tree-chart')
rects.map(r=>{
    let div = document.createElement('div')
    Object.assign(div.style,{
        position: 'absolute',
        border: 'solid 1px black',
        left: r.x+'px', top: r.y+'px', width: r.w+'px', height: r.h+'px'
    })
    treeChart.appendChild(div)
})


const body = document.body;
const main = document.getElementById('main');

var dy=0, sy=0
// Bind a scroll function
window.addEventListener('scroll', e=>{
    console.log(e)
    dy = window.pageYOffset-sy
    sy = window.pageYOffset;
});

function render(){
//   dy*= 0.99
//   dy = Math.floor(dy * 100) / 100;
  main.style.transform = `translate3d(0, ${-dy}px, 0)`;
  window.requestAnimationFrame(render);
}
render()

function li(a, b, n) {
  return (1 - n) * a + n * b;
}
</script>
</html>