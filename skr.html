<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>waves</title>
</head>
<body>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
        <path fill="#0099ff" fill-opacity="1" d="M0,192L34.3,165.3C68.6,139,137,85,206,101.3C274.3,117,343,203,411,240C480,277,549,267,617,234.7C685.7,203,754,149,823,117.3C891.4,85,960,75,1029,90.7C1097.1,107,1166,149,1234,176C1302.9,203,1371,213,1406,218.7L1440,224L1440,0L1405.7,0C1371.4,0,1303,0,1234,0C1165.7,0,1097,0,1029,0C960,0,891,0,823,0C754.3,0,686,0,617,0C548.6,0,480,0,411,0C342.9,0,274,0,206,0C137.1,0,69,0,34,0L0,0Z"></path>
        <path fill="#0099ff" fill-opacity="0.6" d="M0,224L40,197.3C80,171,160,117,240,117.3C320,117,400,171,480,176C560,181,640,139,720,133.3C800,128,880,160,960,154.7C1040,149,1120,107,1200,85.3C1280,64,1360,64,1400,64L1440,64L1440,0L1400,0C1360,0,1280,0,1200,0C1120,0,1040,0,960,0C880,0,800,0,720,0C640,0,560,0,480,0C400,0,320,0,240,0C160,0,80,0,40,0L0,0Z"></path>  
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
        <path fill="#0099ff" fill-opacity="1" d="M0,224L240,224L480,160L720,64L960,96L1200,32L1440,160L1440,320L1200,320L960,320L720,320L480,320L240,320L0,320Z"></path>
        <path fill="#0099ff" fill-opacity="0.6" d="M0,256L240,128L480,128L720,64L960,160L1200,128L1440,32L1440,320L1200,320L960,320L720,320L480,320L240,320L0,320Z"></path>
    </svg>
    <section>
        <div class="bg-img" data-0="transform:translateY(0px)" data-bottom="transform:translateY(-300px)"></div>
        <div class="gradient"></div>
        <div class="bg-bluegrey"></div>
        <div class="skew"></div>
        <div class="bg-img"></div>
    </section>
</body>
<style>
html,body{
    margin: 0;
    height: 100%;
}
.bg-img{
    height: 80vh;
    background: url(static/image/pomodoro.gif);
    background-repeat: no-repeat;
    background-size:cover;
    background-position: center;
    background-attachment: fixed;
}
.gradient{
    height: 50vh;
    margin-top: -50vh;
    background: linear-gradient(180deg,transparent 0%,#5D6D7E 100%);
}
.bg-bluegrey{
    height: 20vh;
    background: #5D6D7E;
}
.skew{
    transform: skewY(-5deg);
    height: 200px;
    margin-top: -100px;
    margin-bottom: -100px;
    background: #5D6D7E;
    box-shadow: 5px 5px 5px 0 #000;
}
</style>
<script>
    function skr(node=document.body){
        let datas = Object.entries(node.dataset)
        let rect = node.getBoundingClientRect()
        let keyPoints = []
        for(let data of datas){
            let [key,value] = data
            let y = undefined
            if(key=='center')
                y = Math.round((rect.bottom-rect.top)/2)
            if(key=='top'||key=='bottom')
                y = rect[key]
            let numeric = key.match(/^(\d+)$/)
            if(numeric)
                y = parseInt(numeric[1])
            if(y!=undefined)
                keyPoints.push({y, cssText:node.dataset[key]})
        }
        if(datas.length){
            keyPoints.sort((a,b)=>a.y-b.y)
            function getMatchArray(string,regexp){
                return Array.from(string.matchAll(regexp),x=>x[0])
            }
            function handleScroll(){
                let cssText = keyPoints[keyPoints.length-1].cssText
                for(let i=1;i<keyPoints.length;i++){
                    if(keyPoints[i].y>window.scrollY){
                        let prev = keyPoints[i-1]
                        let next = keyPoints[i]
                        let ratio = (window.scrollY-prev.y)/(next.y-prev.y)
                        cssText = cssText.replace(/\d+/g, '{}')
                        let prevs = getMatchArray(prev.cssText, /(\d+)/g)
                        let nexts = getMatchArray(next.cssText, /(\d+)/g)
                        prevs.map((a,i)=>{
                            a = parseInt(a)
                            let b = parseInt(nexts[i])
                            let value = Math.round( a*(1-ratio)+b*ratio )
                            cssText = cssText.replace('{}',value)
                        })
                        break
                    }
                }
                node.style.cssText = cssText
            }
            window.addEventListener('scroll',handleScroll)
            handleScroll()
        }
        for(let child of node.children){
            skr(child)   
        }
    }
    skr()
</script>
</html>